<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Habit Builder</title>
  <style>
  body {
  font-family: 'Nunito', sans-serif;
  background: #ffffff;
  color: #333333;
  margin: 0;
  padding: 0;
}

header {
  text-align: center;
  padding: 2rem;
  background: #f8f9fa;
  border-bottom: 2px solid #e0e0e0;
}

header h1 {
  margin: 0;
  font-size: 2.5rem;
  color: #28b485;
}

header p {
  font-size: 1.2rem;
  color: #666666;
}

main {
  padding: 2rem;
  max-width: 600px;
  margin: 0 auto;
}

section {
  margin-bottom: 2rem;
}

input, button {
  font-size: 1rem;
  padding: 0.75rem;
  margin: 0.5rem 0;
  border-radius: 10px;
  border: 1px solid #e0e0e0;
  width: 100%;
  box-sizing: border-box;
}

button {
  background: #28b485;
  border: none;
  color: #ffffff;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s;
}

button:hover {
  background: #249e76;
}

#progressBar {
  height: 10px;
  background: #d1f2eb;
  border-radius: 5px;
  overflow: hidden;
  margin: 1rem 0;
}

#progressFill {
  height: 100%;
  background: #28b485;
  width: 0;
  transition: width 0.5s ease;
}

.dashboard {
  background: #f8f9fa;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  position: relative;
}

#habitList {
  padding-left: 1rem;
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

.fade-out {
  animation: fadeOut 0.5s ease-out;
}

@keyframes fadeIn {
  from {opacity: 0;}
  to {opacity: 1;}
}

@keyframes fadeOut {
  from {opacity: 1;}
  to {opacity: 0;}
}

#welcomePopup h2 {
  color: #28b485;
}

#welcomePopup p {
  color: #666666;
}

#welcomePopup button {
  background: #28b485;
  color: #ffffff;
}

#welcomePopup button:hover {
  background: #249e76;
}

#userTitle {
  position: fixed;
  top: 10px;
  left: 20px;
  font-size: 1.2rem;
  color: #28b485;
  font-weight: bold;
  display: none;
  z-index: 1000;
}
  </style>
</head>
<body>
  <div id="userTitle"></div>

  <header>
    <h1>Habit Builder</h1>
    <p>Visualize. Build. Track. Grow.</p>
  </header>

  <main>
    <section id="auth-section">
      <div class="dashboard">
        <h2>Welcome to Habit Builder ğŸ‘‹</h2>
        <p>Create an account to start your journey:</p>
        <input type="text" id="auth-name" placeholder="Your name" /><br />
        <input type="password" id="auth-password" placeholder="Create a password" /><br />
        <button onclick="completeSignup()">Create Account</button>
        <p style="text-align: center;">
          Already have an account? <a href="#" onclick="showLogin()">Log in</a>
        </p>
      </div>
    </section>
    
    <section id="login-section" style="display: none;">
      <div class="dashboard">
        <h2>Welcome Back ğŸ‘‹</h2>
        <p>Log in to continue building your habits:</p>
        <input type="text" id="login-name" placeholder="Your name" /><br />
        <input type="password" id="login-password" placeholder="Your password" /><br />
        <button onclick="loginUser()">Log In</button>
        <p style="text-align: center;">
          New here? <a href="#" onclick="showSignup()">Create an account</a>
        </p>
      </div>
    </section>


    <section id="onboarding" style="display: none;">
      <div id="progressBar">
        <div id="progressFill"></div>
      </div>
      <h2>Hi there!</h2>
      <p>Letâ€™s make a plan just for you. Whatâ€™s something you want to build into your life?</p>
      <input type="text" id="username" placeholder="Enter your name" /><br /><br />

      <div id="quiz-step-1">
        <p>Whatâ€™s your main long-term priority?</p>
        <button onclick="setLongTermGoal('health')">ğŸ’ª Improve Health</button>
        <button onclick="setLongTermGoal('productivity')">ğŸ“ˆ Be More Productive</button>
        <button onclick="setLongTermGoal('wellbeing')">ğŸ§˜â€â™€ï¸ Boost Wellbeing</button>
        <input type="text" id="customGoal" placeholder="e.g., Wake up earlier" style="display: none; margin-top: 1rem;" />
      </div>

      <div id="quiz-step-2" style="display: none;">
        <p>Whatâ€™s one thing youâ€™d like to improve *this week*?</p>
        <button onclick="setShortTermGoal('exercise')">ğŸ‹ï¸â€â™€ï¸ Exercise 3x this week</button>
        <button onclick="setShortTermGoal('focus')">ğŸ“± Use phone less</button>
        <button onclick="setShortTermGoal('sleep')">ğŸ›Œ Go to bed on time</button>
      </div>

      <br />
      <button id="startBtn" style="display: none;" onclick="startJourney()">Start Your Journey</button>
    </section>

    <section id="dashboard" class="dashboard" style="display: none;">
      <h2>Your Dashboard</h2>
      <div id="avatar">ğŸ‘¤</div>
      <p><strong>Name:</strong> <span id="displayName"></span></p>
      <p><strong>Goal:</strong> <span id="displayGoal"></span></p>

      <div class="habit">
        <h3>Your Habit</h3>
        <input type="text" id="habitInput" placeholder="e.g., Take a walk daily" />
        <button onclick="addHabit()">Add Habit</button>
      </div>

      <ul id="habitList"></ul>
    </section>

    <section id="chatbot" style="display: none;">
      <h2>Chat with HabitBot ğŸ¤–</h2>
      <p>(Placeholder: GPT integration here)</p>
    </section>

    <!-- ğŸŒŸ Welcome Popup -->
    <div id="welcomePopup" style="display: none;" class="fade-in">
      <div style="
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
      ">
        <div style="
          background: #f9f7f2;
          padding: 2rem 3rem;
          border-radius: 20px;
          box-shadow: 0 10px 25px rgba(0,0,0,0.1);
          text-align: center;
          max-width: 90%;
          font-family: 'Nunito', sans-serif;
        ">
          <h2 id="popupGreeting" style="color: #4a4a40;">Hi there!</h2>
          <p style="color: #6e6b5e;">Weâ€™re so glad youâ€™re here. Letâ€™s build something great together âœ¨</p>
          <button onclick="closeWelcome()" style="
            margin-top: 1.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            background: #aacbb0;
            color: #2e3d32;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
          ">Letâ€™s go!</button>

        </div>
      </div>
    </div>
  </main>

  <script>
    function showLogin() {
      document.getElementById("auth-section").style.display = "none";
      document.getElementById("login-section").style.display = "block";
    }
    
    function showSignup() {
      document.getElementById("login-section").style.display = "none";
      document.getElementById("auth-section").style.display = "block";
    }
    
    function loginUser() {
      const loginName = document.getElementById("login-name").value.trim();
      const loginPassword = document.getElementById("login-password").value;
    
      if (!loginName || !loginPassword) {
        alert("Please enter both username and password.");
        return;
      }
    
      const users = getUserDB();
      const match = users.find(user => 
        user.name.toLowerCase() === loginName.toLowerCase() &&
        user.password === hashPassword(loginPassword)
      );
    
      if (!match) {
        alert("Invalid username or password.");
        return;
      }
    
      userName = loginName;
      document.getElementById("popupGreeting").innerText = `Welcome back, ${userName}!`;
      document.getElementById("welcomePopup").style.display = "block";
    
      confetti({
        particleCount: 100,
        spread: 80,
        origin: { y: 0.6 }
      });
    }

    let selectedLongTermGoal = "";
    function hashPassword(password) {
      return btoa(password); // Just for demo â€“ not secure
    }
    
    function getUserDB() {
      return JSON.parse(localStorage.getItem("habitUsers") || "[]");
    }
    
    function saveUserDB(users) {
      localStorage.setItem("habitUsers", JSON.stringify(users));
    }

    let selectedShortTermGoal = "";
    let userName = "";

    function completeSignup() {
  const nameInput = document.getElementById("auth-name").value.trim();
  const password = document.getElementById("auth-password").value;

  if (!nameInput || !password) {
    alert("Please enter both a name and password.");
    return;
  }

  const users = getUserDB();
  const userExists = users.some(user => user.name.toLowerCase() === nameInput.toLowerCase());

  if (userExists) {
    alert("Username already taken.");
    return;
  }

  users.push({ name: nameInput, password: hashPassword(password) });
  saveUserDB(users);

  userName = nameInput;
  document.getElementById("popupGreeting").innerText = `Hi, ${userName}!`;
  document.getElementById("welcomePopup").style.display = "block";

  confetti({
    particleCount: 100,
    spread: 80,
    origin: { y: 0.6 }
  });
}


    
    function closeWelcome() {
      document.getElementById("welcomePopup").classList.add("fade-out");
      setTimeout(() => {
        document.getElementById("welcomePopup").style.display = "none";
        document.getElementById("auth-section").style.display = "none";
        document.getElementById("login-section").style.display = "none";
        document.getElementById("onboarding").style.display = "block";
        document.getElementById("onboarding").classList.add("fade-in");
        document.getElementById("username").value = userName;
      }, 500);
    }

    function updateProgress(percent) {
      document.getElementById("progressFill").style.width = percent + "%";
    }

    function setLongTermGoal(goal) {
      selectedLongTermGoal = goal;
      updateProgress(66);
      if (goal === "health") {
        document.getElementById("customGoal").style.display = "block";
      } else {
        document.getElementById("customGoal").style.display = "none";
      }
      document.getElementById("quiz-step-1").style.display = "none";
      document.getElementById("quiz-step-2").style.display = "block";
    }

    function setShortTermGoal(goal) {
      selectedShortTermGoal = goal;
      updateProgress(100);
      document.getElementById("quiz-step-2").style.display = "none";
      document.getElementById("startBtn").style.display = "inline-block";
    }

    function startJourney() {
      const customGoalInput = document.getElementById("customGoal").value;

      if (!userName || !selectedLongTermGoal || !selectedShortTermGoal) {
        alert("Please complete all steps!");
        return;
      }

      document.getElementById("onboarding").classList.add("fade-out");
      setTimeout(() => {
        document.getElementById("onboarding").style.display = "none";
        document.getElementById("dashboard").style.display = "block";
        document.getElementById("dashboard").classList.add("fade-in");
        document.getElementById("chatbot").style.display = "block";

        document.getElementById("displayName").innerText = userName;
        document.getElementById("displayGoal").innerText =
          `Long-term: ${selectedLongTermGoal}${customGoalInput ? ` (${customGoalInput})` : ''}, Short-term: ${selectedShortTermGoal}`;

        const userTitle = document.getElementById("userTitle");
        userTitle.innerText = `${userName}'s habits`;
        userTitle.style.display = "block";
      }, 600);
    }

    function addHabit() {
      const habit = document.getElementById("habitInput").value;
      if (habit) {
        const listItem = document.createElement("li");
        listItem.textContent = habit;
        document.getElementById("habitList").appendChild(listItem);
        document.getElementById("habitInput").value = "";
      }
    }
  </script>
</body>
</html>
